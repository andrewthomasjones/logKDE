---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-"
)
```

# logKDE: log-transformed kernel density estimation

<img src="http://www.r-pkg.org/badges/version-last-release/logKDE"></img></a>
[![Downloads from the RStudio CRAN mirror](http://cranlogs.r-pkg.org/badges/logKDE)](https://CRAN.R-project.org/package=logKDE)
[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.1317784.svg)](https://doi.org/10.5281/zenodo.1317784)

The goal of logKDE is to provide a set of functions for kernel density estimation on the positive domain, using log-kernel density functions. The main functions of the package are the `logdensity` and `logdensity_fft` functions. The choice of functional syntax was made to resemble those of the `density` function, for conducting kernel density estimation on the real domain. The `logdensity` function conducts density estimation, via first principle computations, whereas `logdensity_fft` utilizes fast-Fourier transformation in order to speed up computation. The use of Rcpp guarantees that both methods are sufficiently fast for large data scenarios.

Currently, a variety of kernel functions and plugin bandwidth methods are available. By default both `logdensity` and `logdensity_fft` are set to use log-normal kernel functions (`kernel = 'gaussian'`) and Silverman's rule-of-thumb bandwidth, applied to log-transformed data (`bw = 'nrd0'`). However, the following kernels are also available:

- log-Epanechnikov (`kernel = 'epanechnikov'`),
- log-Laplace (`kernel = 'laplace'`),
- log-logistic (`kernel = 'logistic'`),
- log-triangular (`kernel = 'triangular'`),
- log-uniform (`kernel = 'uniform'`).

The following plugin bandwidth methods are also available:

- all of the methods that available for density, applied to log-transformed data (see `?bw.nrd` regarding the options),
- unbiased cross-validated bandwidths in the positive domain (`bw = 'bw.logCV'`),
- a Silverman-type rule-of-thumb that optimizes the kernel density estimator fit, compared to a log-normal density function (`bw = 'bw.logG'`).

The `logdensity` and `logdensity_fft` functions also behave in the same way as `density`, when called within the `plot` function. The usual assortment of commands that apply to `plot` output objects can also be called.

For a comprehensive review of the literature on positive-domain kernel density estimation, thorough descriptions of the mathematics relating to the methods that have been described, simulation results, and example applications of the `logKDE` package, please consult the package vignette. The vignette is available via the command `vignette('logKDE')`, once the package is installed.

## Installation

If `devtools` has already been installed, then the most current build of `logKDE` can be obtained via the command:

```{r GH-install, eval=F}
devtools::install_github('andrewthomasjones/logKDE')
```

The latest stable build of `logKDE` can be obtain from CRAN via the command:

```{r CRAN-install, eval = F}
install.packages("logKDE", repos='http://cran.us.r-project.org')
```

An archival build of `logKDE` is available at https://zenodo.org/record/1317784. Manual installation instructions can be found within the R installation and administration manual https://cran.r-project.org/doc/manuals/r-release/R-admin.html.

## Examples

### Example 2

In this first example, we showcase the variety of kernel functions that are available in the package. Here, log-transformed kernel density estimators are constructed using the `logdensity` function.

```{r example2}
## Load 'logKDE' library.
library(logKDE)

## Set a random seed.
set.seed(100)

## Generate strictly positive data.
## Data are generated from a chi-squared distribution with 12 degrees of freedom.
x <- rchisq(100,12)

## Construct a log-KDE using the data, and using each of the available kernel functions
logKDE1 <- logdensity(x,kernel = 'gaussian',from = 0,to = 30)
logKDE2 <- logdensity(x,kernel = 'epanechnikov',from = 0,to = 30)
logKDE3 <- logdensity(x,kernel = 'laplace',from = 0,to = 30)
logKDE4 <- logdensity(x,kernel = 'logistic',from = 0,to = 30)
logKDE5 <- logdensity(x,kernel = 'triangular',from = 0,to = 30)
logKDE6 <- logdensity(x,kernel = 'uniform',from = 0,to = 30)

## Plot the true probability density function of the generative model.
plot(c(0,30),c(0,0.1),type='n',xlab='x',ylab='Density',main='Example 2')
curve(dchisq(x,12),from = 0,to = 30,add = T)

## Plot each of the log-KDE functions, each in a different rainbow() colour.
lines(logKDE1$x,logKDE1$y,col=rainbow(7)[1])
lines(logKDE2$x,logKDE2$y,col=rainbow(7)[2])
lines(logKDE3$x,logKDE3$y,col=rainbow(7)[3])
lines(logKDE4$x,logKDE4$y,col=rainbow(7)[4])
lines(logKDE5$x,logKDE5$y,col=rainbow(7)[5])
lines(logKDE6$x,logKDE6$y,col=rainbow(7)[6])


```
